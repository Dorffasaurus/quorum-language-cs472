use Libraries.Compute.Statistics.DataFrame
use Libraries.Containers.Array
use Libraries.Compute.Statistics.Transforms.SplitRowsTransform
use Libraries.Compute.Random

class KFold
    action Main
        DataFrame frame
        frame:Load("Iris2.csv")
    
        // List to hold all folds
        Array<DataFrame> folds
    
        // Need to figure out even k-folds
        k = 5.0     // For now a hardcored var
        Random random
        seed = random:RandomIntegerBetween(0, 10000)
//        seed = 0  // can set seed for expected results

        Array<DataFrame> frames = KFold(k,seed,frame)     

        // Output
        i = 0
        repeat while i < k
            output frames:Get(i):ToText()
            i = i + 1
        end
    end
    
    action KFold(number k, number seed, DataFrame frame) returns Array<DataFrame>
        // return array
        Array<DataFrame> folds

        percent = 0.0
        i = 0

        repeat while i < k
            percent = 1/(k-i)

            // Add all columns for Transform
            j = 0
            repeat while j < frame:GetSize()
                frame:AddSelectedColumn(j)
                j = j + 1
            end
            
            SplitRowsTransform transform
            transform:SetPercent(percent)
            transform:Transform(frame)
            folds:Add(transform:GetSelectedFrame())     // for return array
            frame = transform:GetRemainderFrame()       // for next iteration
            
            i = i + 1
        end

        return folds
    end
end